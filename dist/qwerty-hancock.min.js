/* Qwerty Hancock 0.5.5 (c) 2012-17 Stuart Memo */

!function(){var e,t,o,n=this,r="undefined"==typeof global?n:n.window,i={},l=!1,s={},u={KeyA:"Cl",KeyW:"C#l",KeyS:"Dl",KeyE:"D#l",KeyD:"El",KeyF:"Fl",KeyT:"F#l",KeyG:"Gl",KeyY:"G#l",KeyH:"Al",KeyU:"A#l",KeyJ:"Bl",KeyK:"Cu",KeyO:"C#u",KeyL:"Du",KeyP:"D#u",Semicolon:"Eu",Quote:"Fu",BracketRight:"F#u",Backslash:"Gu"},c=function(e){return Math.floor((i.width-e)/e)},a=function(e){var t=e||{};i={id:t.id||"keyboard",octaves:t.octaves||3,width:t.width,height:t.height,startNote:t.startNote||"A3",whiteKeyColour:t.whiteKeyColour||"#fff",blackKeyColour:t.blackKeyColour||"#000",activeColour:t.activeColour||"yellow",borderColour:t.borderColour||"#000"};var o=document.getElementById(i.id);void 0===i.width&&(i.width=o.offsetWidth),void 0===i.height&&(i.height=o.offsetHeight),i.startOctave=parseInt(i.startNote.charAt(1),10),D(),Q.call(this,o)},d=function(e){this.destroy();for(var t in e)i[t]=e[t];a.call(this,i)},h=function(e){var t,o,n=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"];return o=3===e.length?e.charAt(2):e.charAt(1),t=n.indexOf(e.slice(0,-1)),t=t<3?t+12+12*(o-1)+1:t+12*(o-1)+1,440*Math.pow(2,(t-49)/12)},y=function(e){null===e&&void 0!==e||(e.style.backgroundColor=i.activeColour)},f=function(e){null!==e&&("white"===e.getAttribute("data-note-type")?e.style.backgroundColor=i.whiteKeyColour:e.style.backgroundColor=i.blackKeyColour)},v=function(e){var t,o=0,n=e.length,r=[];for(t=0;t<n;t++)if(i.startNote.charAt(0)===e[t]){o=t;break}for(t=0;t<n;t++)r[t]=t+o>n-1?e[t+o-n]:e[t+o];return r},p=function(e){e.el.style.backgroundColor=i.whiteKeyColour,e.el.style.border="1px solid "+i.borderColour,e.el.style.borderRight=0,e.el.style.height=i.height+"px",e.el.style.width=e.width+"px",e.el.style.borderRadius="0 0 5px 5px",e.noteNumber===L()-1&&(e.el.style.border="1px solid "+i.borderColour)},m=function(e){var t=c(L()),o=Math.floor(t/2);e.el.style.backgroundColor=i.blackKeyColour,e.el.style.border="1px solid "+i.borderColour,e.el.style.position="absolute",e.el.style.left=Math.floor((t+1)*(e.noteNumber+1)-o/2)+"px",e.el.style.width=o+"px",e.el.style.height=i.height/1.5+"px",e.el.style.borderRadius="0 0 3px 3px"},w=function(e){e.el.style.display="inline-block",e.el.style["-webkit-user-select"]="none","white"===e.colour?p(e):m(e)},g=function(e){var t=function(e){e.style.cursor="default",e.style.fontSize="0px",e.style.height=i.height+"px",e.style.padding=0,e.style.position="relative",e.style.listStyle="none",e.style.margin=0,e.style.width=i.width+"px",e.style["-webkit-user-select"]="none"};t(e.container),t(e.el)},b=function(e,t){"li"===e.tagName.toLowerCase()&&(l=!0,y(e),t(e.title,h(e.title)))},k=function(e,t){"li"===e.tagName.toLowerCase()&&(l=!1,f(e),t(e.title,h(e.title)))},E=function(e,t){l&&(y(e),t(e.title,h(e.title)))},C=function(e,t){l&&(f(e),t(e.title,h(e.title)))},K=function(e){return e.el=document.createElement("li"),e.el.id=e.id,e.el.title=e.id,e.el.setAttribute("data-note-type",e.colour),w(e),e},L=function(){return 7*i.octaves},x=function(){var e,t,o=this,n=[],r=0,l=i.startOctave,s=L();for(e=0;e<s;e++)e%this.whiteNotes.length==0&&(r=0),"C"===this.whiteNotes[r]&&0!==e&&l++,t=K({colour:"white",octave:l,width:c(s),id:this.whiteNotes[r]+l,noteNumber:e}),n.push(t.el),e!==s-1&&this.notesWithSharps.forEach(function(i,u){i===o.whiteNotes[r]&&(t=K({colour:"black",octave:l,width:c(s)/2,id:o.whiteNotes[r]+"#"+l,noteNumber:e}),n.push(t.el))}),r++;return n},N=function(e){e.keys.forEach(function(t){e.el.appendChild(t)})},A=function(e){i.keyPressOffset="C"===e[0]?0:1},D=function(){var e={container:document.getElementById(i.id),el:document.createElement("ul"),whiteNotes:v(["C","D","E","F","G","A","B"]),notesWithSharps:v(["C","D","F","G","A"])};return e.keys=x.call(e),A(e.whiteNotes),g(e),N(e),e.container.appendChild(e.el),e},B=function(){var e=document.getElementById(i.id);e.innerHTML="",e.removeAttribute("style")},I=function(e){return u[e].replace("l",parseInt(i.startOctave,10)+i.keyPressOffset).replace("u",(parseInt(i.startOctave,10)+i.keyPressOffset+1).toString())},F=function(e,t){var o;return!(e.code in s)&&(s[e.code]=!0,void 0!==u[e.code]&&(o=I(e.code),t(o,h(o)),y(document.getElementById(o)),!0))},O=function(e,t){var o;return delete s[e.code],void 0!==u[e.code]&&(o=I(e.code),t(o,h(o)),f(document.getElementById(o)),!0)},G=function(e){return e.ctrlKey||e.metaKey||e.altKey},H=function(e){G(e)||F(e,this.keyDown)&&e.preventDefault()},S=function(e){G(e)||O(e,this.keyUp)&&e.preventDefault()},M=function(e){switch(e.type){case"mousedown":case"touchstart":b(e.target,this.keyDown);break;case"mouseup":case"touchend":k(e.target,this.keyUp);break;case"mouseover":E(e.target,this.keyDown);break;case"mouseout":case"touchleave":case"touchcancel":C(e.target,this.keyUp)}},Q=function(n){e=H.bind(this),t=S.bind(this),o=M.bind(this),r.addEventListener("keydown",e),r.addEventListener("keyup",t),n.addEventListener("mousedown",o),n.addEventListener("mouseup",o),n.addEventListener("mouseover",o),n.addEventListener("mouseout",o),"ontouchstart"in document.documentElement&&(n.addEventListener("touchstart",o),n.addEventListener("touchend",o),n.addEventListener("touchleave",o),n.addEventListener("touchcancel",o))},U=function(n){r.removeEventListener("keydown",e),r.removeEventListener("keyup",t),n.removeEventListener("mousedown",o),n.removeEventListener("mouseup",o),n.removeEventListener("mouseover",o),n.removeEventListener("mouseout",o),"ontouchstart"in document.documentElement&&(n.removeEventListener("touchstart",o),n.removeEventListener("touchend",o),n.removeEventListener("touchleave",o),n.removeEventListener("touchcancel",o))},P=function(e){return void 0===i[e]},R=function(e){this.version="0.5.5",this.keyDown=function(){},this.keyUp=function(){},a.call(this,e)};R.prototype.get=function(e){if(P(e))throw new Error('QwertyHancock.get: "'+e+"\" doesn't exist.");return i[e]},R.prototype.set=function(e,t){if("string"==typeof e){var o={};o[e]=t,e=o}var n=0;for(var r in e)P(r)?delete e[r]:n+=1;if(!(n>0))throw new Error("QwertyHancock.set: invalid parameter");d.call(this,e)},R.prototype.pauseListener=function(){var e=document.getElementById(i.id);U.call(this,e)},R.prototype.resumeListener=function(){var e=document.getElementById(i.id);Q.call(this,e)},R.prototype.destroy=function(){this.pauseListener(),B()},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=R),exports.QwertyHancock=R):n.QwertyHancock=R}();